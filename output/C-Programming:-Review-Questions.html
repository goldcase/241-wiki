<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.6.0/pure-min.css">
	<link rel="stylesheet" href="style.css">
    <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
</head>
<body>
<h2>Warning - question numbers subject to change</h2>
<h1>Memory and Strings</h1>
<h2>Q1.1</h2>
<p>In the example below, which variables are guaranteed to print the value of zero?</p>
<div class="highlight"><pre><span class="kt">int</span> <span class="n">a</span><span class="p">;</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">b</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">func</span><span class="p">()</span> <span class="p">{</span>
   <span class="k">static</span> <span class="kt">int</span> <span class="n">c</span><span class="p">;</span>
   <span class="kt">int</span> <span class="n">d</span><span class="p">;</span>
   <span class="n">printf</span><span class="p">(</span><span class="s">&quot;%d %d %d %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>


<h2>Q 1.2</h2>
<p>In the example below, which variables are guaranteed to print the value of zero?</p>
<div class="highlight"><pre><span class="kt">void</span> <span class="nf">func</span><span class="p">()</span> <span class="p">{</span>
   <span class="kt">int</span><span class="o">*</span> <span class="n">ptr1</span> <span class="o">=</span> <span class="n">malloc</span><span class="p">(</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="p">);</span>
   <span class="kt">int</span><span class="o">*</span> <span class="n">ptr2</span> <span class="o">=</span> <span class="n">realloc</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="p">);</span>
   <span class="kt">int</span><span class="o">*</span> <span class="n">ptr3</span> <span class="o">=</span> <span class="n">calloc</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="p">);</span>
   <span class="kt">int</span><span class="o">*</span> <span class="n">ptr4</span> <span class="o">=</span> <span class="n">calloc</span><span class="p">(</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

   <span class="n">printf</span><span class="p">(</span><span class="s">&quot;%d %d %d %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="o">*</span><span class="n">ptr1</span><span class="p">,</span><span class="o">*</span><span class="n">ptr2</span><span class="p">,</span><span class="o">*</span><span class="n">ptr3</span><span class="p">,</span><span class="o">*</span><span class="n">ptr</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>


<h2>Q 1.3</h2>
<p>Explain the error in the following attempt to copy a string.</p>
<div class="highlight"><pre><span class="kt">char</span><span class="o">*</span> <span class="nf">copy</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="n">src</span><span class="p">)</span> <span class="p">{</span>
 <span class="kt">char</span><span class="o">*</span><span class="n">result</span> <span class="o">=</span> <span class="n">malloc</span><span class="p">(</span> <span class="n">strlen</span><span class="p">(</span><span class="n">src</span><span class="p">)</span> <span class="p">);</span> 
 <span class="n">strcpy</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">src</span><span class="p">);</span> 
 <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<h2>Q 1.4</h2>
<p>Why does the following attempt to copy a string sometimes work and sometimes fail?</p>
<div class="highlight"><pre><span class="kt">char</span><span class="o">*</span> <span class="nf">copy</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="n">src</span><span class="p">)</span> <span class="p">{</span>
 <span class="kt">char</span><span class="o">*</span><span class="n">result</span> <span class="o">=</span> <span class="n">malloc</span><span class="p">(</span> <span class="n">strlen</span><span class="p">(</span><span class="n">src</span><span class="p">)</span> <span class="o">+</span><span class="mi">1</span> <span class="p">);</span> 
 <span class="n">strcat</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">src</span><span class="p">);</span> 
 <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<h2>Q 1.4</h2>
<p>Explain the two errors in the following code that attempts to copy a string.</p>
<div class="highlight"><pre><span class="kt">char</span><span class="o">*</span> <span class="nf">copy</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="n">src</span><span class="p">)</span> <span class="p">{</span>
 <span class="kt">char</span> <span class="n">result</span><span class="p">[</span><span class="k">sizeof</span><span class="p">(</span><span class="n">src</span><span class="p">)];</span> 
 <span class="n">strcpy</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">src</span><span class="p">);</span> 
 <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<h2>Q 1.5</h2>
<p>Which of the following is legal?</p>
<div class="highlight"><pre><span class="kt">char</span> <span class="n">a</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&quot;Hello&quot;</span><span class="p">;</span> <span class="n">strcpy</span><span class="p">(</span><span class="s">&quot;World&quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">);</span>
<span class="kt">char</span> <span class="n">b</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&quot;Hello&quot;</span><span class="p">;</span> <span class="n">strcpy</span><span class="p">(</span><span class="s">&quot;World12345&quot;</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
<span class="kt">char</span><span class="o">*</span> <span class="n">c</span> <span class="o">=</span> <span class="s">&quot;Hello&quot;</span><span class="p">;</span> <span class="n">strcpy</span><span class="p">(</span><span class="s">&quot;World&quot;</span><span class="p">,</span> <span class="n">c</span><span class="p">);</span>
</pre></div>


<h2>Q 1.6</h2>
<p>Complete the function pointer typedef to declare a pointer to a function that takes a void<em> argument and returns a void</em>. Name your type 'pthread_callback'</p>
<div class="highlight"><pre><span class="k">typedef</span> <span class="n">______________________</span><span class="p">;</span>
</pre></div>


<h2>Q 1.7</h2>
<p>In addition to the function arguments what else is stored on a thread's stack?</p>
<h1>Printing</h1>
<h2>Q 2.1</h2>
<p>Spot the error!</p>
<div class="highlight"><pre><span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">&quot;You scored 100%&quot;</span><span class="p">);</span>
</pre></div>


<h1>Formatting and Printing to a file</h1>
<h2>Q 3.1</h2>
<p>Complete the following code to print to a file. Print the name, a comma and the score to the file 'result.txt'</p>
<div class="highlight"><pre><span class="kt">char</span><span class="o">*</span> <span class="n">name</span> <span class="o">=</span> <span class="p">.....;</span>
<span class="kt">int</span> <span class="n">score</span> <span class="o">=</span> <span class="p">......</span>
<span class="kt">FILE</span> <span class="o">*</span><span class="n">f</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="s">&quot;result.txt&quot;</span><span class="p">,</span><span class="n">_____</span><span class="p">);</span>
<span class="k">if</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">_____</span>
<span class="p">}</span>
<span class="n">fclose</span><span class="p">(</span><span class="n">f</span><span class="p">);</span>
</pre></div>


<h1>Printing to a string</h1>
<h2>Q 4.1</h2>
<p>How would you print the values of variables a,mesg,val and ptr to a string? Print a as an integer, mesg as C string, val as a double val and ptr as a hexadecimal pointer. You may assume the mesg points to a short C string(&lt;50 characters).<br />
Bonus: How would you make this code more robust or able to cope with?<br />
```C<br />
char<em> toString(int a, char</em>mesg, double val, void<em> ptr) {<br />
   char</em> result = malloc( strlen(mesg) + 50);<br />
    _____<br />
   return result;<br />
}</p>
<h1>Input parsing</h1>
<h2>Q 5.1</h2>
<p>Why should you check the return value of sscanf and scanf?</p>
<h2>Q 5.2</h2>
<p>Why is 'gets' dangerous?</p>
<h2>Q 5.3</h2>
<p>Write a complete program that uses <code>getline</code>. Ensure your program has no memory leaks.</p>
<h2>Heap memory</h2>
<p>When would you use calloc not malloc? <br />
When would realloc be useful?</p>
<p>(Todo - move this question to another page)<br />
What mistake did the programmer make in the following code? Is it possible to fix it i) using heap memory? ii) using global (static) memory?</p>
<div class="highlight"><pre><span class="k">static</span> <span class="kt">int</span> <span class="n">id</span><span class="p">;</span>

<span class="kt">char</span><span class="o">*</span> <span class="nf">next_ticket</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">id</span> <span class="o">++</span><span class="p">;</span>
  <span class="kt">char</span> <span class="n">result</span><span class="p">[</span><span class="mi">20</span><span class="p">];</span>
  <span class="n">sprintf</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="s">&quot;%d&quot;</span><span class="p">,</span><span class="n">id</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
    <script src="check_mc.js"></script>
</body>
</html>
</body>
</html>
